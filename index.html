<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <title>Timeline - 연결선 개선</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body { font-family: "Segoe UI", Roboto, "Noto Sans KR", sans-serif; padding: 20px; background:#fff; }
    .chart-container { display:flex; justify-content:center; }
    svg { overflow: visible; }
  </style>
</head>
<body>
  <h2>타임라인 (연결선 개선)</h2>
  <div class="chart-container">
    <svg id="timeline-chart" width="1000" height="360"></svg>
  </div>

  <script src="https://d3js.org/d3.v7.min.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      const data = [
        { label: '대학교 교양수업으로 Java 배우기', startDate: new Date(2000,0,1) },
        { label: '2017년 춘계학술발표대회 학부생 논문경진대회 – 금상', startDate: new Date(2000,0,2) },
        { label: 'Unity를 활용한 VR/AR 교육 (160시간)', startDate: new Date(2000,0,3) },
        { label: 'JAVA 웹개발 스택 교육과정 수료', startDate: new Date(2000,0,4) },
        { label: '운 좋게 바로 JAVA 개발자로 취뽀 성공', startDate: new Date(2000,0,5) },
        { label: '웹 개발의 처음과 끝을 완성해보다.', startDate: new Date(2000,0,6) },
        { label: '나라는 존재를 개발 세상에 알리는 중!', startDate: new Date(2000,0,7) }
      ];

      const width = 900, height = 300;
      const margin = { top: 20, right: 20, bottom: 20, left: 20 };
      const effectiveWidth = width * 0.9;
      const timelineY = (height - margin.top - margin.bottom) / 2 + margin.top;

      const svgRoot = d3.select("#timeline-chart")
        .attr("width", width + margin.left + margin.right)
        .attr("height", height + margin.top + margin.bottom);

      const defs = svgRoot.append("defs");
      const grad = defs.append("linearGradient")
        .attr("id", "timeline-gradient")
        .attr("gradientUnits", "userSpaceOnUse")
        .attr("x1", 0).attr("y1", 0)
        .attr("x2", effectiveWidth).attr("y2", 0);
      grad.append("stop").attr("offset","0%").attr("stop-color","#28a745");
      grad.append("stop").attr("offset","33%").attr("stop-color","#ffc107");
      grad.append("stop").attr("offset","66%").attr("stop-color","#dc3545");
      grad.append("stop").attr("offset","100%").attr("stop-color","#6f42c1");

      const svg = svgRoot.append("g")
        .attr("transform", `translate(${margin.left}, ${margin.top})`);

      const xScale = d3.scaleTime()
        .domain([d3.min(data, d=>d.startDate), d3.max(data, d=>d.startDate)])
        .range([0, effectiveWidth]);

      // 메인 타임라인을 좀 더 얇게 만들어서 연결선이 보이도록 개선
      const mainLine = svg.append("line")
        .attr("x1", 0).attr("y1", timelineY - margin.top)
        .attr("x2", effectiveWidth).attr("y2", timelineY - margin.top)
        .attr("stroke-width", 4) // 8에서 4로 줄임
        .attr("stroke-linecap", "round")
        .style("stroke", "url(#timeline-gradient)")
        .style("opacity", 0.8); // 약간 투명하게

      const colors = ["#ffc107", "#007bff", "#28a745", "#dc3545", "#6f42c1", "#e83e8c", "#fd7e14"];

      // 점들 사이 연결선을 더 두껍고 진하게 개선
      for (let i = 1; i < data.length; i++) {
        svg.append("line")
          .attr("x1", xScale(data[i-1].startDate))
          .attr("y1", timelineY - margin.top)
          .attr("x2", xScale(data[i].startDate))
          .attr("y2", timelineY - margin.top)
          .attr("stroke-width", 3) // 2에서 3으로 증가
          .attr("stroke-linecap", "round")
          .style("stroke", "#333") // #888에서 #333으로 더 진하게
          .style("opacity", 1); // 0.9에서 1로 불투명하게
      }

      const groups = svg.selectAll(".item")
        .data(data)
        .enter()
        .append("g")
        .attr("class", "item");

      // 원을 좀 더 크게 만들어서 연결선과 구분되도록
      groups.append("circle")
        .attr("cx", d => xScale(d.startDate))
        .attr("cy", timelineY - margin.top)
        .attr("r", 8) // 7에서 8로 증가
        .attr("fill", (d,i) => colors[i % colors.length])
        .attr("stroke", "#fff") // 흰색 테두리로 변경
        .attr("stroke-width", 2); // 테두리도 두껍게

      const rotationAngle = -45;
      groups.append("text")
        .attr("x", d => xScale(d.startDate))
        .attr("y", timelineY - margin.top - 15) // 좀 더 위로
        .text(d => d.label)
        .attr("text-anchor", "start")
        .attr("dominant-baseline", "hanging")
        .style("font-size", "13px")
        .style("fill", (d,i) => colors[i % colors.length])
        .style("font-weight", "600") // 폰트 두껍게
        .attr("transform", function(d) {
          const x = xScale(d.startDate);
          const y = timelineY - margin.top - 15;
          return `rotate(${rotationAngle}, ${x}, ${y})`;
        })
        .attr("pointer-events", "none");
    });
  </script>
</body>
</html>