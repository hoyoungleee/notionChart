<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <title>Timeline - 연결선 개선</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body { font-family: "Segoe UI", Roboto, "Noto Sans KR", sans-serif; padding: 20px; background:#fff; }
    .chart-container { display:flex; justify-content:center; }
    svg { overflow: visible; }
    
    .tooltip {
      position: absolute;
      padding: 12px 16px;
      background: rgba(0, 0, 0, 0.9);
      color: white;
      border-radius: 8px;
      font-size: 14px;
      line-height: 1.4;
      max-width: 300px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      pointer-events: none;
      opacity: 0;
      transform: translateY(-10px);
      transition: all 0.3s ease;
      z-index: 1000;
    }
    
    .tooltip.show {
      opacity: 1;
      transform: translateY(-5px);
    }
    
    .tooltip::after {
      content: '';
      position: absolute;
      top: 100%;
      left: 50%;
      margin-left: -5px;
      border: 5px solid transparent;
      border-top-color: rgba(0, 0, 0, 0.9);
    }
    
    .tooltip-title {
      font-weight: bold;
      margin-bottom: 8px;
      color: #ffd700;
    }
    
    .tooltip-content {
      font-size: 13px;
      color: #e0e0e0;
    }
  </style>
</head>
<body>
  <h2>타임라인 (연결선 개선)</h2>
  <div class="chart-container">
    <svg id="timeline-chart" width="1000" height="360"></svg>
  </div>
  <div class="tooltip" id="tooltip">
    <div class="tooltip-title"></div>
    <div class="tooltip-content"></div>
  </div>

  <script src="https://d3js.org/d3.v7.min.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      const data = [
        { 
          label: '대학교 교양수업으로 Java 배우기', 
          startDate: new Date(2000,0,1),
          tooltip: {
            title: 'Java 프로그래밍 첫 걸음',
            content: '객체지향 프로그래밍의 기초를 배우며 개발자로서의 첫 발을 내딛었습니다. 변수, 조건문, 반복문부터 시작해서 클래스와 객체의 개념까지 익혔어요.'
          }
        },
        { 
          label: '2017년 춘계학술발표대회 학부생 논문경진대회 – 금상', 
          startDate: new Date(2000,0,2),
          tooltip: {
            title: '학술 성취의 첫 번째 결실',
            content: '연구 능력과 문제 해결 역량을 인정받아 금상을 수상했습니다. 이론과 실무를 결합한 연구로 학계에서도 인정받는 성과를 거두었어요.'
          }
        },
        { 
          label: 'Unity를 활용한 VR/AR 교육 (160시간)', 
          startDate: new Date(2000,0,3),
          tooltip: {
            title: '차세대 기술 몰입 학습',
            content: '160시간 동안 Unity 엔진을 마스터하며 VR/AR 개발 역량을 키웠습니다. 3D 모델링, 물리 엔진, 사용자 인터렉션까지 체계적으로 학습했어요.'
          }
        },
        { 
          label: 'JAVA 웹개발 스택 교육과정 수료', 
          startDate: new Date(2000,0,4),
          tooltip: {
            title: '풀스택 개발자로의 전환점',
            content: 'Spring Framework, JSP, Servlet, Database 연동까지 웹 개발의 전체 스택을 마스터했습니다. 실무 중심의 프로젝트로 실전 경험을 쌓았어요.'
          }
        },
        { 
          label: '운 좋게 바로 JAVA 개발자로 취뽀 성공', 
          startDate: new Date(2000,0,5),
          tooltip: {
            title: '개발자 커리어의 시작',
            content: '체계적인 학습과 프로젝트 경험을 바탕으로 첫 개발자 포지션에 성공적으로 입사했습니다. 이론에서 실무로, 새로운 도전의 시작이었어요.'
          }
        },
        { 
          label: '웹 개발의 처음과 끝을 완성해보다.', 
          startDate: new Date(2000,0,6),
          tooltip: {
            title: 'End-to-End 개발 경험',
            content: '기획부터 배포까지 웹 서비스의 전체 생명주기를 경험했습니다. 프론트엔드, 백엔드, 데이터베이스, 인프라까지 풀스택 역량을 키웠어요.'
          }
        },
        { 
          label: '나라는 존재를 개발 세상에 알리는 중!', 
          startDate: new Date(2000,0,7),
          tooltip: {
            title: '개발자로서의 정체성 확립',
            content: '기술 블로그, 오픈소스 기여, 커뮤니티 활동을 통해 개발자로서의 브랜딩을 시작했습니다. 지속적인 성장과 지식 공유로 영향력을 확대해 나가고 있어요.'
          }
        }
      ];

      const width = 900, height = 300;
      const margin = { top: 20, right: 20, bottom: 20, left: 20 };
      const effectiveWidth = width * 0.9;
      const timelineY = (height - margin.top - margin.bottom) / 2 + margin.top;

      const svgRoot = d3.select("#timeline-chart")
        .attr("width", width + margin.left + margin.right)
        .attr("height", height + margin.top + margin.bottom);

      const defs = svgRoot.append("defs");
      const grad = defs.append("linearGradient")
        .attr("id", "timeline-gradient")
        .attr("gradientUnits", "userSpaceOnUse")
        .attr("x1", 0).attr("y1", 0)
        .attr("x2", effectiveWidth).attr("y2", 0);
      grad.append("stop").attr("offset","0%").attr("stop-color","#28a745");
      grad.append("stop").attr("offset","33%").attr("stop-color","#ffc107");
      grad.append("stop").attr("offset","66%").attr("stop-color","#dc3545");
      grad.append("stop").attr("offset","100%").attr("stop-color","#6f42c1");

      const svg = svgRoot.append("g")
        .attr("transform", `translate(${margin.left}, ${margin.top})`);

      const xScale = d3.scaleTime()
        .domain([d3.min(data, d=>d.startDate), d3.max(data, d=>d.startDate)])
        .range([0, effectiveWidth]);

      // 메인 타임라인을 좀 더 얇게 만들어서 연결선이 보이도록 개선
      const mainLine = svg.append("line")
        .attr("x1", 0).attr("y1", timelineY - margin.top)
        .attr("x2", effectiveWidth).attr("y2", timelineY - margin.top)
        .attr("stroke-width", 4) // 8에서 4로 줄임
        .attr("stroke-linecap", "round")
        .style("stroke", "url(#timeline-gradient)")
        .style("opacity", 0.8); // 약간 투명하게

      const colors = ["#ffc107", "#007bff", "#28a745", "#dc3545", "#6f42c1", "#e83e8c", "#fd7e14"];

      // 점들 사이 연결선을 더 두껍고 진하게 개선
      for (let i = 1; i < data.length; i++) {
        svg.append("line")
          .attr("x1", xScale(data[i-1].startDate))
          .attr("y1", timelineY - margin.top)
          .attr("x2", xScale(data[i].startDate))
          .attr("y2", timelineY - margin.top)
          .attr("stroke-width", 3) // 2에서 3으로 증가
          .attr("stroke-linecap", "round")
          .style("stroke", "#333") // #888에서 #333으로 더 진하게
          .style("opacity", 1); // 0.9에서 1로 불투명하게
      }

      const groups = svg.selectAll(".item")
        .data(data)
        .enter()
        .append("g")
        .attr("class", "item");

      // 원을 좀 더 크게 만들어서 연결선과 구분되도록
      groups.append("circle")
        .attr("cx", d => xScale(d.startDate))
        .attr("cy", timelineY - margin.top)
        .attr("r", 8) // 7에서 8로 증가
        .attr("fill", (d,i) => colors[i % colors.length])
        .attr("stroke", "#fff") // 흰색 테두리로 변경
        .attr("stroke-width", 2) // 테두리도 두껍게
        .style("cursor", "pointer")
        .on("mouseover", function(event, d) {
          // 호버 시 원 크기 증가 애니메이션
          d3.select(this)
            .transition()
            .duration(200)
            .attr("r", 12)
            .attr("stroke-width", 3);
          
          // 툴팁 표시
          const tooltip = d3.select("#tooltip");
          tooltip.select(".tooltip-title").text(d.tooltip.title);
          tooltip.select(".tooltip-content").text(d.tooltip.content);
          
          tooltip.classed("show", true);
        })
        .on("mousemove", function(event) {
          // 마우스 위치에 따라 툴팁 위치 조정
          const tooltip = d3.select("#tooltip");
          const rect = document.body.getBoundingClientRect();
          const x = event.pageX;
          const y = event.pageY;
          
          tooltip
            .style("left", (x - 150) + "px")
            .style("top", (y - 100) + "px");
        })
        .on("mouseout", function() {
          // 호버 종료 시 원 크기 복원
          d3.select(this)
            .transition()
            .duration(200)
            .attr("r", 8)
            .attr("stroke-width", 2);
          
          // 툴팁 숨김
          d3.select("#tooltip").classed("show", false);
        });

      const rotationAngle = -45;
      groups.append("text")
        .attr("x", d => xScale(d.startDate))
        .attr("y", timelineY - margin.top - 15) // 좀 더 위로
        .text(d => d.label)
        .attr("text-anchor", "start")
        .attr("dominant-baseline", "hanging")
        .style("font-size", "13px")
        .style("fill", (d,i) => colors[i % colors.length])
        .style("font-weight", "600") // 폰트 두껍게
        .attr("transform", function(d) {
          const x = xScale(d.startDate);
          const y = timelineY - margin.top - 15;
          return `rotate(${rotationAngle}, ${x}, ${y})`;
        })
        .attr("pointer-events", "none");
    });
  </script>
</body>
</html>